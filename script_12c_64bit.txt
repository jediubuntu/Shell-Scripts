@echo off
net use S: /d
net use S: \\slc14urx\patches /user:guest
net use 
dir S:

set ORACLE_HOME=
:: delims is a TAB followed by a space
FOR /F "tokens=3* delims= " %%A IN ('reg query HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\KEY_OraClient12Home1\ /v ORACLE_HOME') DO SET ORACLE_HOME=%%A

set PATH=%ORACLE_HOME%\bin;%PATH%

set PATH=%ORACLE_HOME%\OPatch;%PATH%

set PATH=%ORACLE_HOME%\perl\bin;%PATH%

net stop IISADMIN
net stop OracleOraClient12Home1_32bitMTSRecoveryService
net stop MSDTC
net stop TrkWks
net stop Dnscache
net stop PFService
net stop PFSyncService
net stop InForm Model Updater
net stop IPAService
net stop OracleOraClient11g_home1ConfigurationManager
net stop W3SVC
net stop InFormServerAdapterService
net stop InFormServerAdapterServiceIA1371
net stop OracleRemExecServiceV2
net stop OracleOraClient12Home1_32bitMTSRecoveryService
net stop OracleOraClient12Home1_32bitTNSListener
net stop Argus Safety Windows Service
net stop Argus Web Service
net stop Argus Insight Service

rd /s /q C:\tmp_patch

mkdir C:\tmp_patch

cd C:\tmp_patch

cp S:\p26720785_121020_MSWIN-x86-64.zip C:\tmp_patch

unzip p26720785_121020_MSWIN-x86-64.zip

cd 26720785

call opatch apply -silent

cd %ORACLE_HOME%\ODP.NET\bin\2.x

rd /s /q C:\tmp_patch

oraprovcfg.exe /action:gac /providerpath:Oracle.DataAccess.dll

net start IISADMIN
net start OracleOraClient12Home1_32bitMTSRecoveryService
net start MSDTC
net start TrkWks
net start Dnscache
net start PFService
net start PFSyncService
net start InForm Model Updater
net start IPAService
net start OracleOraClient11g_home1ConfigurationManager
net start W3SVC
net start InFormServerAdapterService
net start InFormServerAdapterServiceIA1371
net start OracleRemExecServiceV2
net start OracleOraClient12Home1_32bitMTSRecoveryService
net start OracleOraClient12Home1_32bitTNSListener
net start Argus Safety Windows Service
net start Argus Web Service
net start Argus Insight Service

